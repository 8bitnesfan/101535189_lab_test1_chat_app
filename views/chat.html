<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chat</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

<h2>Chat Room</h2>

<div id="chatBox" class="border p-3 mb-3" style="height: 300px; overflow-y: scroll;"></div>

<form id="chatForm" class="d-flex">
  <input id="messageInput" class="form-control me-2" placeholder="Type a message..." required>
  <button class="btn btn-primary">Send</button>
</form>

<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
  const socket = io();

  const chatBox = $("#chatBox");
  const room = "general";
  socket.emit("joinRoom", room);
  socket.on("chatMessage", (data) => {
    chatBox.append(`<div><strong>${data.username}:</strong> ${data.message}</div>`);
    chatBox.scrollTop(chatBox[0].scrollHeight);
  });

  $("#chatForm").submit(function(e) {
    e.preventDefault();
    const message = $("#messageInput").val();
    if (!message) return;

    socket.emit("chatMessage", { room, username: "You", message });
    $("#messageInput").val("");
  });
</script>

</body>
</html>
